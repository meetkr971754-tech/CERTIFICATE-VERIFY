<!doctype html>
<html>
<head>
  <meta charset="utf-8">
  <title>Certificate Verification</title>
  <style>
    body{font-family:Arial;max-width:700px;margin:40px auto;}
    input{padding:10px;width:80%;font-size:16px;}
    button{padding:10px;font-size:16px;}
    .result{margin-top:20px;padding:15px;border-radius:8px;border:1px solid #ccc;}
  </style>
</head>
<body>
  <h2>Certificate Verification</h2>
  <p>Enter Certificate ID (eg. MH-EH-2025-0001):</p>
  <input id="qid" placeholder="Certificate ID"/>
  <button onclick="verify()">Verify</button>
  <div id="out"></div>

<script>
// CHANGE THIS to your published CSV URL (from Google Sheets -> Publish -> CSV)
const CSV_URL = "https://docs.google.com/spreadsheets/d/YOUR_SHEET_ID/pub?output=csv";

let data = [];
fetch(CSV_URL)
  .then(r=>r.text())
  .then(txt=>{
    const rows = txt.trim().split('\n').map(r=>r.split(','));
    const headers = rows.shift().map(h=>h.replace(/(^"|"$)/g,''));
    data = rows.map(r=>{
      const obj = {};
      r.forEach((c,i)=> obj[headers[i]] = (c||"").replace(/(^"|"$)/g,''));
      return obj;
    });
  });

function verify(){
  const id = document.getElementById('qid').value.trim();
  const out = document.getElementById('out');
  out.innerHTML = '';
  if(!id){ out.innerHTML = '<div class="result">Please enter an ID.</div>'; return;}
  const found = data.find(d => (d.ID || d["Unique ID"] || d["Certificate ID"] || "").toLowerCase() === id.toLowerCase());
  if(found){
    out.innerHTML = `<div class="result">
      <strong>Valid Certificate</strong><br>
      Name: ${found.Name || found["Student Name"] || ''} <br>
      Course: ${found.Course || ''} <br>
      Date: ${found.Date || ''} <br>
      <a href="${found.PDF || found['Certificate Link'] || '#'}" target="_blank">Open Certificate (PDF)</a>
    </div>`;
  } else {
    out.innerHTML = '<div class="result">Certificate not found (invalid ID).</div>';
  }
}
</script>
</body>
</html>
